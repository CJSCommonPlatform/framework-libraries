dist: trusty
sudo: required
language: java
jdk:
- oraclejdk8
git:
  depth: 3
cache:
  directories:
  - "$HOME/.m2"
services:
- postgresql
before_script:
- psql -c 'create database frameworkeventstore;' -U postgres
- psql -c 'create database frameworkviewstore;' -U postgres
- psql -c 'create database frameworkfilestore;' -U postgres
- psql -c 'create database frameworkjobstore;' -U postgres
- psql -c "CREATE USER framework WITH PASSWORD 'framework';" -U postgres
addons:
  postgresql: '9.5'
  sonarcloud:
    organization: cjscommonplatform
    token:
      secure: ZBz8zPk4549R1/oaajQe3O+oiREiK8uhWjmQ3tzG9VSMrbJknEyzYlkkr+MLAXqJSPtK8VNMUdTbs8TR/dMN3TbwCZhVy80FPe4Bpw9HrXmxyFpReSIegzY066ZYnfmDy+xgef2ffroznjLDtms0p7nfZ/M+qeE8I5n7ZVI74Ajda/JxMz8U6YguwZtvGiLHAblYpDuLpx5hPhqVYF6fYG+FhJrgdB9sp35D0IbtrBZSbF19Q/8QHIDnoWm6qqfqn6bNbLMw/vPtkxRQ1OwzVxyfDxOshy8LImgRLSb/kc6ZQo9TOLUm56NOQdTeMGqyaL80GizZ8FttuDCLF8PdJfZUiq8by9uCwb9gjg5z0nkw+nYOJPPxKPuQcHqKopZ880Zegn2CVk7mlfoYfNiJ2RBkPcIWKEbpS/h1bEypBia5wDiFgQW8W6PbXVv+zt1BW1aoMsdv1uCsx2/wNaE4JKk7YmQGQeb82MZ2OSumkSSkUPfqeE/lxLMxb4YTWZ/ockJncV30IwXDAjO8vNbFDbC5PidU5mn9fSYnbLWTpfauW/x3JRtJ0tcN14G8QwtkXvuKYe0bxdHwKlorqkKDlpRTSfwsbnSFLyc4/hZaddlQkwVU+8tFqndfWS44m0LegCdLcFfLdi1+l4XKV+BRT7y+fyIikvyKk6sA93wVrhY=
    github_token:
      secure: RsXGIpQmJraoRy7X9T3oFgukPbcNJUizoP9MNW8CLCE5Cm6gTKrmZkk8lxr2fv07Nd1GnprmFd6YywyZIVL/S1EDmJdNDbBVrPB/FKIdTzt2KNOZQrEMdGJpGT8QI7z5wQbEvmJC1Mp3DW+9As1VhWd/jy9xvpTWXLw565jGgny9xXpAd8D2Trw+qcP3rpMiqCtSyxydlE48cPyZOF2T/fnb3NiPq0rqf+Mpj5fF0ODQbDcsEfH3rth1lF4qbLHep8my+ZxnNMd+BPUn+uwf6IMZp2G3dyIPLCbE9Mkr71jdiptTxkFfYRTRGIhvjIoKjOZdN2V1jA6oM9KVXjnW7J3lwImFNgoU+zGUEJrd2IX6CA+mxHJsDoAaye34JLhUqqf+r9DVeU0tJS7G7YQpE4GhhiL2v2SSJKw3Xp8m5qRXKD4/dZIxafpABHuJ3Pdfirx5lKyVMSPXMYMnShGipZL0zKXQMU+k12Q1wMrTKMSWsLd0tCzQTPz9NSwVO+buwck4f/CPgn1zYqnO68bXdA7ooD7RCZA6tA1GAv70fAryfNklUh4a4gt8lPnRbdqY7ifJ9Ysxj0QXI/qiyV9U1fDFsNSayLYKkoug8o0qtUbo2fBl8wO/NYN/NVT5h8tvgElwTT0xtgr5xLDRdA1XQhCpEaFluL3QEjqwN+EbUOU=
before_install:
- git clone https://github.com/CJSCommonPlatform/travis-settings.git target/travis-settings
- ln -sfT ${PWD}/target/travis-settings/settings.xml ${HOME}/.m2/settings.xml
- ln -sfT ${PWD}/target/travis-settings/mvnw mvnw
- ln -sft ${PWD} ${PWD}/target/travis-settings/.mvn
install: "${PWD}/target/travis-settings/java/install.sh -e -q -DexcludeGroupIds=uk.gov.justice.service,uk.gov.justice.services"
script: "${PWD}/target/travis-settings/java/script-install.sh coveralls:report sonar:sonar"
after_success: "${PWD}/target/travis-settings/java/after_success.sh"
env:
  global:
  - PGPORT=5432
  - secure: Cro2ZI2Zoj35gMHDKTV3vsDk+wKhSBHWwqHNXaZQotHRhHXiXVf/CI2+pofs6lwUpY4vLCATWkWqDiXMq8tehiiukUOdUCi4iHSEKnGRwo8v0ZB8hV3By8sl8lcW03qEQIbTxswLrP03BWhcoVV6+qpqWp836vHET4gI6FFm4Ow2cYz+eIG+m3anSQYY7l3cFwF9nOP58pgaukBc65D4rwqI+urCClU8Do557tD7it1XPChOxyOlc6D+PReCFjjXD16WIHEeiqAZmbD5VsVnQHFHo6DkhfR+9dELEE4tHXezzkLqsYv5vJ8kkkCKJ5q4SGTeoZzACEvSCP8ZwMiLWztQcYV8dsuKG/T4DaM6vL3K4bRqCF491j2xUWj6TDYKeKqIvkYtAUZmHbIrxB0dfUrBm3xmMB2leUFy7sMP2GVJqIY6EJgDsAjZ6/0G9NrwcifO5SeulfSIN8CVO1FKpEd044yxeoiRGlvE78S5IN/1EWxlYnnuJuE+8Y9OUXtPopi67/z3+j+6qrAI/KsajRzcKiw/LpbfbjyzqaPW0oRFaVO/jHiKz5x/J+MeLw+935ppBREUUDGuESGs4eE45MA3LTwvNoyfCt22ywMLtulGG3nZopTzhFse3JERty5JNyBIGeCyfbBXmq2yYc+1BJlDjskEtfyqVJQlQau35QA=
  - secure: A7RL2PxLB/FX7T6usHSDo34wFBJ30r6kkSq28rXFSBF5ah4qYfvunB70Jl1xJrTFVydQ9LyrXWJcY/1lxE0gYVIGGfOb/TzPvrHqFCmIW3cAvCdHqZ8MY84VOwmESDxqiWyoArs3jAWauDT1fRQGLPZkV5L/2lkcvR57/vaHt/PtHydhs9MVLGSfPhO2adS+ULF9EQnfXVxitzLy3pQiIHZYyHTb/Abj3/ZU/4ZTo786iF38+tYQj78UbVh/OaCKT+6+soa78GgQhIdnF00YHy2MEQMSnjFKN6Vb8Ow3/yxgjZWFvtBERaC/Xm1at2xDlYuLilgUv/JgKn3JxZnusnlWmVYKSxM4KoDOQ7q7JU813kqzYxfxRRMrBmNHw7Tk1xwq8SxrOhpkmne/uKUOl6TZQZm5skhunVIqRU5f7iWAlPUG6V5rMYUOWkacmKftFn2GLZXqASLFPRn7Cc8XlmqhWb1Y11NAP7ht0B8jiwCNqLDKp/uiDNDbj2DdkW0Yr3hK1g0kwo7EFov9DLYnWrK9lhRLi+1hykYcvf8uzZ8EiNSaXaCG2D7H67hB3o2vMmYem+aNNsW4LgrDcWfDz7/YlgrT112Mh5sg3Y3ZKCSRTD5Q2bB9S9NvvAjtwv1WSQ+CRg9sBsoBF9CUJBOPJHfIDWDGwnlQBDs81VHREYs=
